(function(e){function t(t){for(var a,s,r=t[0],c=t[1],l=t[2],u=0,d=[];u<r.length;u++)s=r[u],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&d.push(i[s][0]),i[s]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);f&&f(t);while(d.length)d.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,s=1;s<n.length;s++){var r=n[s];0!==i[r]&&(a=!1)}a&&(o.splice(t--,1),e=c(c.s=n[0]))}return e}var a={},s={app:0},i={app:0},o=[];function r(e){return c.p+"js/"+({}[e]||e)+"."+{"chunk-9fb29f5a":"374bdb4f","chunk-a893a800":"cdb56150","chunk-fe7a90fc":"ed76d0d2"}[e]+".js"}function c(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n={"chunk-9fb29f5a":1,"chunk-a893a800":1,"chunk-fe7a90fc":1};s[e]?t.push(s[e]):0!==s[e]&&n[e]&&t.push(s[e]=new Promise((function(t,n){for(var a="css/"+({}[e]||e)+"."+{"chunk-9fb29f5a":"a000a6d4","chunk-a893a800":"8d8c0c92","chunk-fe7a90fc":"0088eff7"}[e]+".css",i=c.p+a,o=document.getElementsByTagName("link"),r=0;r<o.length;r++){var l=o[r],u=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(u===a||u===i))return t()}var d=document.getElementsByTagName("style");for(r=0;r<d.length;r++){l=d[r],u=l.getAttribute("data-href");if(u===a||u===i)return t()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=t,f.onerror=function(t){var a=t&&t.target&&t.target.src||i,o=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=a,delete s[e],f.parentNode.removeChild(f),n(o)},f.href=i;var m=document.getElementsByTagName("head")[0];m.appendChild(f)})).then((function(){s[e]=0})));var a=i[e];if(0!==a)if(a)t.push(a[2]);else{var o=new Promise((function(t,n){a=i[e]=[t,n]}));t.push(a[2]=o);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,c.nc&&u.setAttribute("nonce",c.nc),u.src=r(e);var d=new Error;l=function(t){u.onerror=u.onload=null,clearTimeout(f);var n=i[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+a+": "+s+")",d.name="ChunkLoadError",d.type=a,d.request=s,n[1](d)}i[e]=void 0}};var f=setTimeout((function(){l({type:"timeout",target:u})}),12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(t)},c.m=e,c.c=a,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(n,a,function(t){return e[t]}.bind(null,a));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/user/",c.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],u=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var f=u;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"038a":function(e,t,n){"use strict";n("0be3")},"0be3":function(e,t,n){},"0d0a":function(e,t,n){},"0e3b":function(e,t,n){},"171e":function(e,t,n){e.exports=n.p+"img/head.a723abb7.jpg"},"210e":function(e,t,n){},2696:function(e,t,n){"use strict";n("3271")},"2f5c":function(e,t,n){},3271:function(e,t,n){},3356:function(e,t,n){},3364:function(e,t,n){"use strict";n("3356")},"4dcb":function(e,t,n){},"555a":function(e,t,n){e.exports=n.p+"img/icon.7cbcce6c.png"},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var a=n("2b0e"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},i=[],o={name:"app",components:{}},r=o,c=(n("8ea1"),n("0c7c")),l=Object(c["a"])(r,s,i,!1,null,null,null),u=l.exports,d=n("cee4"),f=(n("0fb7"),n("450d"),n("f529")),m=n.n(f),h=(n("46a1"),n("e5f2")),p=n.n(h),g=(n("9e1f"),n("6ed5")),v=n.n(g),b=(n("be4f"),n("896a")),w=n.n(b),k=(n("bc1c"),n("4726")),y=n.n(k),_=(n("f92a"),n("d775")),C=n.n(_),S=(n("279e"),n("7d94")),I=n.n(S),x=(n("fa4c"),n("e360")),D=n.n(x),T=(n("acb6"),n("c673")),R=n.n(T),$=(n("e3ea"),n("7bc3")),M=n.n($),E=(n("fd71"),n("a447")),O=n.n(E),A=(n("2f02"),n("fe11")),j=n.n(A),N=(n("ed7b"),n("e1a5")),B=n.n(N),P=(n("bdc7"),n("aa2f")),H=n.n(P),L=(n("de31"),n("c69e")),U=n.n(L),V=(n("a769"),n("5cc3")),W=n.n(V),F=(n("a673"),n("7b31")),q=n.n(F),z=(n("adec"),n("3d2d")),G=n.n(z),J=(n("6762"),n("dd3d")),K=n.n(J),Y=(n("a586"),n("7464")),Q=n.n(Y),X=(n("28b2"),n("c7ad")),Z=n.n(X),ee=(n("b0ee"),n("d180")),te=n.n(ee),ne=(n("a335"),n("c0bb")),ae=n.n(ne),se=(n("186a"),n("301f")),ie=n.n(se),oe=(n("96dc"),n("9cea")),re=n.n(oe),ce=(n("9c49"),n("6640")),le=n.n(ce),ue=(n("d2ac"),n("95b0")),de=n.n(ue),fe=(n("78a7"),n("33ca")),me=n.n(fe),he=(n("b8e0"),n("a4c4")),pe=n.n(he),ge=(n("e2f3"),n("06f9")),ve=n.n(ge),be=(n("f3e4"),n("9dda")),we=n.n(be),ke=(n("6b30"),n("c284")),ye=n.n(ke),_e=(n("f225"),n("89a9")),Ce=n.n(_e),Se=(n("f4f9"),n("c2cc")),Ie=n.n(Se),xe=(n("7a0f"),n("0f6c")),De=n.n(xe),Te=(n("aaa5"),n("a578")),Re=n.n(Te),$e=(n("b5c2"),n("20cf")),Me=n.n($e),Ee=(n("915d"),n("e04d")),Oe=n.n(Ee),Ae=(n("5e32"),n("6721")),je=n.n(Ae),Ne=(n("cbb5"),n("8bbc")),Be=n.n(Ne),Pe=(n("e612"),n("dd87")),He=n.n(Pe),Le=(n("075a"),n("72aa")),Ue=n.n(Le),Ve=(n("eca7"),n("3787")),We=n.n(Ve),Fe=(n("425f"),n("4105")),qe=n.n(Fe),ze=(n("b84d"),n("c216")),Ge=n.n(ze),Je=(n("8f24"),n("76b9")),Ke=n.n(Je),Ye=(n("0c67"),n("299c")),Qe=n.n(Ye),Xe=(n("06f1"),n("6ac9")),Ze=n.n(Xe),et=(n("4ffc"),n("946e")),tt=n.n(et),nt=(n("d624"),n("3e9c")),at=n.n(nt),st=(n("826b"),n("c263")),it=n.n(st),ot=(n("5466"),n("ecdf")),rt=n.n(ot),ct=(n("38a0"),n("ad41")),lt=n.n(ct),ut=(n("ae26"),n("845f")),dt=n.n(ut),ft=(n("1951"),n("eedf")),mt=n.n(ft),ht=(n("016f"),n("486c")),pt=n.n(ht),gt=(n("6611"),n("e772")),vt=n.n(gt),bt=(n("1f1a"),n("4e4b")),wt=n.n(bt),kt=(n("e960"),n("b35b")),yt=n.n(kt),_t=(n("d4df"),n("7fc1")),Ct=n.n(_t),St=(n("c526"),n("1599")),It=n.n(St),xt=(n("560b"),n("dcdc")),Dt=n.n(xt),Tt=(n("3c52"),n("0d7b")),Rt=n.n(Tt),$t=(n("fe07"),n("6ac5")),Mt=n.n($t),Et=(n("b5d8"),n("f494")),Ot=n.n(Et),At=(n("9d4c"),n("e450")),jt=n.n(At),Nt=(n("10cb"),n("f3ad")),Bt=n.n(Nt),Pt=(n("34db"),n("3803")),Ht=n.n(Pt),Lt=(n("8bd8"),n("4cb2")),Ut=n.n(Lt),Vt=(n("ce18"),n("f58e")),Wt=n.n(Vt),Ft=(n("4ca3"),n("443e")),qt=n.n(Ft),zt=(n("bd49"),n("18ff")),Gt=n.n(zt),Jt=(n("960d"),n("defb")),Kt=n.n(Jt),Yt=(n("cb70"),n("b370")),Qt=n.n(Yt),Xt=(n("3db2"),n("58b8")),Zt=n.n(Xt),en=(n("a7cc"),n("df33")),tn=n.n(en),nn=(n("672e"),n("101e")),an=n.n(nn);a["default"].use(an.a),a["default"].use(tn.a),a["default"].use(Zt.a),a["default"].use(Qt.a),a["default"].use(Kt.a),a["default"].use(Gt.a),a["default"].use(qt.a),a["default"].use(Wt.a),a["default"].use(Ut.a),a["default"].use(Ht.a),a["default"].use(Bt.a),a["default"].use(jt.a),a["default"].use(Ot.a),a["default"].use(Mt.a),a["default"].use(Rt.a),a["default"].use(Dt.a),a["default"].use(It.a),a["default"].use(Ct.a),a["default"].use(yt.a),a["default"].use(wt.a),a["default"].use(vt.a),a["default"].use(pt.a),a["default"].use(mt.a),a["default"].use(dt.a),a["default"].use(lt.a),a["default"].use(rt.a),a["default"].use(it.a),a["default"].use(at.a),a["default"].use(tt.a),a["default"].use(Ze.a),a["default"].use(Qe.a),a["default"].use(Ke.a),a["default"].use(Ge.a),a["default"].use(qe.a),a["default"].use(We.a),a["default"].use(Ue.a),a["default"].use(He.a),a["default"].use(Be.a),a["default"].use(je.a),a["default"].use(Oe.a),a["default"].use(Me.a),a["default"].use(Re.a),a["default"].use(De.a),a["default"].use(Ie.a),a["default"].use(Ce.a),a["default"].use(ye.a),a["default"].use(we.a),a["default"].use(ve.a),a["default"].use(pe.a),a["default"].use(me.a),a["default"].use(de.a),a["default"].use(le.a),a["default"].use(re.a),a["default"].use(ie.a),a["default"].use(ae.a),a["default"].use(te.a),a["default"].use(Z.a),a["default"].use(Q.a),a["default"].use(K.a),a["default"].use(G.a),a["default"].use(q.a),a["default"].use(W.a),a["default"].use(U.a),a["default"].use(H.a),a["default"].use(B.a),a["default"].use(j.a),a["default"].use(O.a),a["default"].use(M.a),a["default"].use(R.a),a["default"].use(D.a),a["default"].use(I.a),a["default"].use(C.a),a["default"].use(y.a),a["default"].use(w.a.directive),a["default"].prototype.$loading=w.a.service,a["default"].prototype.$msgbox=v.a,a["default"].prototype.$alert=v.a.alert,a["default"].prototype.$confirm=v.a.confirm,a["default"].prototype.$prompt=v.a.prompt,a["default"].prototype.$notify=p.a,a["default"].prototype.$message=m.a;var sn=n("8c4f"),on=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("HeaderNav"),n("router-view")],1)},rn=[],cn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"head"},[a("img",{staticClass:"pic",attrs:{src:n("555a"),alt:"这是一个图标"}}),a("el-menu",{staticClass:"nav",attrs:{"default-active":e.activeMenu,mode:"horizontal","active-text-color":"#8B4513"}},[a("el-menu-item",{attrs:{index:"/"}},[e._v("首页")]),a("el-menu-item",{attrs:{index:"/film"},nativeOn:{click:function(t){return e.handleClick(t)}}},[e._v("心理测试")]),a("el-menu-item",{attrs:{index:"/cinema"},nativeOn:{click:function(t){return e.handleClick(t)}}},[e._v("AI对话")]),a("el-menu-item",{attrs:{index:"/myfilm"},nativeOn:{click:function(t){return e.handleClick(t)}}},[e._v("阅读天地")]),a("el-submenu",{staticClass:"user-menu",attrs:{index:"user"}},[a("template",{slot:"title"},[a("div",{staticClass:"user-container"},[a("span",[e._v(e._s(e.User))]),e.unread>0?a("span",{staticClass:"dot"}):e._e()])]),a("el-menu-item",{on:{click:e.personalbar}},[a("span",[e._v("\n            个人主页\n            "),e.unread>0?a("span",{staticClass:"dot-inline"}):e._e()])]),a("el-menu-item",{on:{click:e.LogoutHeadle}},[e._v("退出")])],2)],1)],1)},ln=[],un={data:function(){return{activeMenu:"/",User:localStorage.getItem("username"),unread:0,token:localStorage.getItem("token")}},mounted:function(){this.count()},methods:{count:function(){var e=this;this.$axios.get("/user/notification/newnum",{headers:{token:this.token},params:{userId:localStorage.getItem("userId")}}).then((function(t){"1"===t.data.code&&(e.unread=t.data.data)}))},handleClick:function(){this.$message({message:"正在开发，敬请期待！",type:"warning"})},LogoutHeadle:function(){localStorage.removeItem("LoginState"),localStorage.removeItem("username"),localStorage.removeItem("userId"),this.$router.push({name:"Login"})},personalbar:function(){this.$router.push({name:"Personal"})}}},dn=un,fn=(n("e6a9"),Object(c["a"])(dn,cn,ln,!1,null,"568b07ef",null)),mn=fn.exports,hn={components:{HeaderNav:mn}},pn=hn,gn=Object(c["a"])(pn,on,rn,!1,null,null,null),vn=gn.exports,bn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h1",[e._v("咨询师详情")]),a("div",[a("img",{staticStyle:{width:"150px",height:"150px","border-radius":"50%"},attrs:{src:n("171e")}}),a("h2",[e._v(e._s(e.consultantName))]),a("p",[e._v("咨询师简介："+e._s(e.consultantInfo))])]),e.consultantId?a("el-card",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"date-list"},e._l(e.dateGroups,(function(t){return a("el-button",{key:t.date,staticStyle:{"margin-bottom":"10px",width:"100%"},attrs:{type:e.selectedDate===t.date?"primary":""},on:{click:function(n){e.selectedDate=t.date}}},[e._v("\n            "+e._s("now"===t.date?"现在在线":t.date)+"\n          ")])})))]),a("el-col",{attrs:{span:18}},[a("div",{staticStyle:{"text-align":"center"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.currentTimes,"header-row-class-name":"custom-header","empty-text":"该日期没有可用时间段"}},[a("el-table-column",{attrs:{label:"时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(t.row.time)+"\n              ")]}}])}),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return["now"===e.selectedDate?[a("el-button",{attrs:{type:"text"},on:{click:function(n){e.GotoChat(t.row,1)}}},[e._v("\n                    进入对话\n                  ")])]:["available"===t.row.status?a("el-button",{attrs:{type:"text",disabled:!e.isAppointmentActive(t.row)},on:{click:function(n){e.createConsultation(t.row)}}},[e._v("\n                    预约\n                  ")]):a("span",{staticStyle:{color:"#999"}},[e._v("已满员")])]]}}])})],1)],1)])],1)],1):a("p",[e._v("咨询师信息未找到。")]),a("el-dialog",{attrs:{title:"心理咨询保密协议书",visible:e.showProtocolDialog,width:"600px"},on:{"update:visible":function(t){e.showProtocolDialog=t}}},[a("div",{staticStyle:{"max-height":"400px","overflow-y":"auto","margin-bottom":"20px"}},[a("h3",[e._v("一、保密内容")]),a("p",[e._v("心理咨询师本着尊重、保护来访者个人隐私的态度，对心理咨询过程中的有关信息，包括个案记录、测验资料、信件、录音和其他资料，均属专业信息，都将在严格保密的情况下进行保存。同时，心理咨询师还必须严格遵守职业道德中保密原则的有关规定，严守咨询个案的相关资料。")]),a("h3",[e._v("二、查阅权限")]),a("p",[e._v("上述保密资料，除华东师范大学心理研究院，任何人均不得查阅。")]),a("h3",[e._v("三、录音授权")]),a("p",[e._v("心理咨询师只有在征得来访者同意的情况下才能对咨询过程进行笔录、录音。")])]),a("div",{staticStyle:{display:"flex","align-items":"center","margin-top":"20px"}},[a("el-checkbox",{model:{value:e.agreeProtocol,callback:function(t){e.agreeProtocol=t},expression:"agreeProtocol"}},[e._v("我已阅读并同意此协议")])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showProtocolDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",disabled:!e.agreeProtocol},on:{click:e.confirmGotoChat}},[e._v("\n        确 定\n      ")])],1)])],1)},wn=[],kn=(n("8615"),n("55dd"),n("28a5"),n("3835")),yn=(n("ffc1"),n("ac6a"),n("96cf"),n("1da1")),_n=(n("7f7f"),n("7514"),{data:function(){return{consultantId:parseInt(this.$route.params.id),token:localStorage.getItem("token"),consultantName:"",appselectedTime:"",consultantInfo:"",dateGroups:[],selectedDate:"",showProtocolDialog:!1,agreeProtocol:!1,selectedRow:null}},computed:{currentTimes:function(){var e=this,t=this.dateGroups.find((function(t){return t.date===e.selectedDate}));return t?t.times:[]}},mounted:function(){this.fetchConsultantDetails();var e=JSON.parse(sessionStorage.getItem("consultantData"));e&&(this.consultantName=e.name,this.appselectedTime=e.appselectedTime,this.consultantInfo=e.info,sessionStorage.removeItem("consultantData"))},methods:{fetchConsultantDetails:function(){var e=Object(yn["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$axios.get("/user/consultant",{headers:{token:this.token},params:{consultantID:this.consultantId}});case 3:if(t=e.sent,"1"===t.data.code){e.next=7;break}return this.$message.error("获取信息失败："+t.data.message),e.abrupt("return");case 7:this.formatConsultants(t.data.data),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),this.$message.error("获取信息失败");case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));function t(){return e.apply(this,arguments)}return t}(),formatConsultants:function(e){var t={};Object.entries(e).forEach((function(e){var n=Object(kn["a"])(e,2),a=n[0],s=n[1];if("-999999999-01-01T00:00"!==a){var i=a.split("T")[0],o=a.split("T")[1].slice(0,5);t[i]||(t[i]={date:i,times:[]}),t[i].times.push({time:o,status:"AVAILABLE"===s?"available":"busy",rawTime:a})}else t["now"]={date:"now",times:[{time:"现在在线",status:"available",rawTime:a}]}})),this.dateGroups=Object.values(t).sort((function(e,t){return"now"===e.date?-1:"now"===t.date?1:void("now"===t.date||e.date.localeCompare(t.date))})),this.dateGroups.length>0&&(this.selectedDate="现在在线"===this.appselectedTime?this.dateGroups[0].date:this.appselectedTime)},GotoChat:function(e){this.selectedRow=e,this.showProtocolDialog=!0},confirmGotoChat:function(){var e=this;if(this.agreeProtocol){this.showProtocolDialog=!1;var t=new URLSearchParams;t.append("consultantId",this.consultantId),t.append("userId",parseInt(localStorage.getItem("userId"))),Object(yn["a"])(regeneratorRuntime.mark((function n(){var a,s,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$axios.post("/user/session",t,{headers:{token:e.token,"Content-Type":"application/x-www-form-urlencoded"}});case 3:a=n.sent,a.data&&"1"===a.data.code?(s=a.data.data.sessionId,i=e.$router.resolve({path:"/chat/".concat(s),query:{consultantId:e.consultantId,consultantName:e.consultantName,appointmentDate:e.selectedRow.time,sessionId:s}}).href,window.open(i,"_blank"),e.agreeProtocol=!1):e.$message.error(a.data.msg||"未知错误"),n.next=10;break;case 7:n.prev=7,n.t0=n["catch"](0),e.$message.error("预约失败");case 10:case"end":return n.stop()}}),n,null,[[0,7]])})))()}else this.$message.warning("请先阅读并同意协议")},createConsultation:function(){var e=Object(yn["a"])(regeneratorRuntime.mark((function e(t){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={userId:parseInt(localStorage.getItem("userId")),consultantId:this.consultantId,appointmentDate:this.selectedDate,appointmentTime:t.time},e.prev=1,e.next=4,this.$axios.post("/user/book",n,{headers:{token:this.token}});case 4:a=e.sent,"1"===a.data.code?(this.$message.success("预约成功"),this.fetchConsultantDetails()):this.$message.error(a.data.msg),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),this.$message.error("预约失败");case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));function t(t){return e.apply(this,arguments)}return t}(),isAppointmentActive:function(e){return"available"===e.status}}}),Cn=_n,Sn=(n("2696"),Object(c["a"])(Cn,bn,wn,!1,null,null,null)),In=Sn.exports,xn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"schedule-container"},[n("div",{staticClass:"header"},[e.isCalendarView?n("div",e._l(e.monthRange,(function(t){return n("span",{key:t,class:["date-item",{selected:e.selectedMonth===t}],on:{click:function(n){e.onDateClick(t)}}},[e._v("\n    "+e._s(t)+"月\n  ")])}))):e._e(),n("div",{staticStyle:{width:"20%",height:"10px"}}),n("button",{on:{click:e.toggleView}},[e._v("\n      切换至 "+e._s(e.isCalendarView?"列表":"日历")+" 视图\n    ")])]),e.isCalendarView?n("div",{staticClass:"calendar-view"},[e._l(e.weekdays,(function(t){return n("div",{key:t,staticClass:"weekday"},[e._v(e._s(t))])})),e._l(e.firstDayOffset,(function(e){return n("div",{key:"empty"+e,staticClass:"day empty"})})),e._l(e.monthDays,(function(t){return n("div",{key:t.date,class:["day",{past:t.isPast}],on:{click:function(n){e.showSchedule(t.date)}}},[n("div",[e._v(e._s(t.date))]),e._l(e.getDayAppointments(t.date),(function(t){return n("div",{key:t.appointmentId,staticClass:"appointment-slot"},["booked"===t.status?n("div",{staticClass:"appointment-item-booked"},[e._v("\n          预约\n        ")]):"completed"===t.status?n("div",{staticClass:"appointment-item"},[e._v("\n          已完成\n        ")]):e._e()])}))],2)}))],2):n("div",{staticClass:"list-view"},[n("h2",[e._v("会话记录")]),n("el-form",{staticClass:"filter-form",staticStyle:{"margin-bottom":"16px"},attrs:{inline:!0}},[n("el-form-item",{attrs:{label:"会话时间"}},[n("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.filterDate,callback:function(t){e.filterDate=t},expression:"filterDate"}})],1),n("el-form-item",[n("el-button",{staticStyle:{"background-color":"#FFE4B5",color:"#8B4513"},on:{click:e.fetchSessions}},[e._v("\n        筛选\n      ")])],1)],1),n("div",{staticClass:"session-records"},[n("div",{staticClass:"session-card-container"},e._l(e.filteredSessions,(function(t){return n("div",{key:t.sessionId,staticClass:"session-card"},[n("div",{staticClass:"session-left"},[n("p",[n("strong",[e._v(e._s(t.startTime))])]),n("p",[e._v(e._s(t.consultantName))])]),n("div",{staticClass:"session-right"},[n("div",{staticClass:"rating"},[null!==t.rating?n("el-rate",{attrs:{value:t.rating,disabled:""}}):e._e()],1),n("p",{staticClass:"feedback"},[e._v(e._s(t.feedback||"未填写评价"))])]),n("div",{staticClass:"session-actions"},[n("el-button",{staticStyle:{"background-color":"#FFE4B5",color:"#8B4513","border-color":"#FFE4B5"},attrs:{size:"small",type:"primary"},on:{click:function(n){e.openDetailDialog(t.sessionId)}}},[e._v("\n            咨询详情\n          ")])],1)])}))),n("el-dialog",{staticClass:"custom-dialog",attrs:{visible:e.detailDialogVisible,"show-close":!1,title:"咨询详情",width:"50%"},on:{"update:visible":function(t){e.detailDialogVisible=t}}},[n("div",{staticClass:"chat-history"},e._l(e.sessionHistory,(function(t){return n("div",{key:t.time,class:["chat-bubble",t.senderType?"consultant":"user"]},[n("div",{staticClass:"chat-meta"},[n("span",{staticClass:"sender"},[e._v(e._s(t.senderType?"咨询师":"来访者"))]),n("span",{staticClass:"time"},[e._v(e._s(e.formatTime(t.time)))])]),n("div",{staticClass:"chat-msg"},[e._v(e._s(t.msg))])])}))),n("div",{staticStyle:{"text-align":"right","margin-top":"20px"}},[n("el-button",{staticStyle:{"background-color":"#FFE4B5",color:"#8B4513","border-color":"#FFE4B5","border-radius":"6px"},attrs:{type:"primary"},on:{click:function(t){e.detailDialogVisible=!1}}},[e._v("\n        关闭\n      ")])],1)])],1)],1)])},Dn=[],Tn=(n("5df3"),n("1c4c"),n("c5f6"),n("6b54"),n("f576"),n("2909")),Rn={data:function(){return{hoverCloseButton:!1,userId:localStorage.getItem("userId"),username:localStorage.getItem("username"),token:localStorage.getItem("token"),isCalendarView:!0,currentMonth:(new Date).getMonth()+1,currentMonthName:new Intl.DateTimeFormat("en",{month:"long"}).format(new Date),weekdays:["Mon","Tue","Wed","Thur","Fri","Sat","Sun"],monthDays:[],firstDayOffset:0,scheduleList:[],showLeaveModal:!1,leaveReason:"",currentAppointmentId:null,appointments:[],monthRange:[],selectedMonth:(new Date).getMonth()+1,sessions:[],sessionHistory:[],detailDialogVisible:!1,filterDate:null}},mounted:function(){this.generateMonth(),this.fetchAppointments(),this.fetchSessions()},computed:{filteredSessions:function(){return Object(Tn["a"])(this.sessions).sort((function(e,t){var n=new Date("".concat(e.startTime)),a=new Date("".concat(t.startTime));return a-n}))}},methods:{fetchSessions:function(){var e=Object(yn["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t={userId:localStorage.getItem("userId")},this.filterDate&&2===this.filterDate.length&&(t.startDate=this.formatDate(this.filterDate[0]),t.endDate=this.formatDate(this.filterDate[1])),e.next=5,this.$axios.get("/user/session/list",{headers:{token:this.token},params:t});case 5:n=e.sent,"1"===n.data.code?(this.sessions=n.data.data,this.sessions.sort((function(e,t){return new Date(t.startTime)-new Date(e.startTime)}))):this.$message.error("获取会话列表失败："+n.data.msg),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),this.$message.error("请求错误："+e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(){return e.apply(this,arguments)}return t}(),openDetailDialog:function(e){var t=this;this.$axios.get("/user/session/history",{headers:{token:this.token},params:{sessionId:e}}).then((function(e){"1"===e.data.code?(t.sessionHistory=e.data.data,t.detailDialogVisible=!0):"2"===e.data.code?t.$message(e.data.msg):t.$message.error("获取会话列表失败："+e.data.msg)})).catch((function(e){t.$message.error("请求错误："+e)}))},fetchAppointments:function(){var e=Object(yn["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$axios.get("/user/appointments",{headers:{token:this.token},params:{userId:parseInt(this.userId,10)}});case 3:t=e.sent,"1"===t.data.code?this.appointments=t.data.data.filter((function(e){return"canceled"!==e.status})).sort((function(e,t){return new Date(t.appointmentDate)-new Date(e.appointmentDate)})):this.appointments=[],e.next=11;break;case 7:e.prev=7,e.t0=e["catch"](0),this.$message.error("获取预约数据失败"),this.appointments=[];case 11:return e.prev=11,this.generateMonthData(this.selectedMonth),e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[0,7,11,14]])})));function t(){return e.apply(this,arguments)}return t}(),formatTime:function(e){var t=new Date(e);return"".concat(t.getFullYear(),"-").concat((t.getMonth()+1).toString().padStart(2,"0"),"-").concat(t.getDate().toString().padStart(2,"0")," ").concat(t.getHours().toString().padStart(2,"0"),":").concat(t.getMinutes().toString().padStart(2,"0"))},generateMonth:function(){var e=Object(yn["a"])(regeneratorRuntime.mark((function e(){var t,n,a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(t=[],t[0]=(new Date).getMonth()+1,n=1;n<3;n++)a=(new Date).getMonth()+1-n,t.push(a);s=(new Date).getMonth()+2,this.monthRange=t.reverse(),this.monthRange.push(s);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onDateClick:function(e){this.selectedMonth=e,this.generateMonthData(this.selectedMonth)},Tohome:function(){this.$router.push({path:"/userHome"})},toggleView:function(){this.isCalendarView=!this.isCalendarView},showSchedule:function(e){var t=this;this.isCalendarView=!1,this.$nextTick((function(){var n=t.scheduleList.find((function(t){return t.date===e}));n&&document.querySelector('tr[data-date="'.concat(e,'"]')).scrollIntoView()}))},formatDisplayDate:function(e){var t=e.split(/[-/]/),n=Object(kn["a"])(t,2),a=n[1],s=a.padStart(2,"0");return Number(s)},cancelAppointment:function(e,t){var n=this;this.$axios.post("/user/cancel",{headers:{token:this.token},appointmentId:parseInt(e,10),cancellationReason:t}).then((function(){n.$message.success("预约已取消"),n.fetchAppointments()})).catch((function(){n.$message.error("取消预约失败，请稍后重试")}))},openCancelModal:function(e){this.currentAppointmentId=e,this.showLeaveModal=!0},closeCancelModal:function(){this.showLeaveModal=!1,this.leaveReason="",this.currentAppointmentId=null},submitCancel:function(){this.leaveReason.trim()?(this.cancelAppointment(this.currentAppointmentId,this.leaveReason),this.closeCancelModal()):alert("请填写取消理由")},generateMonthData:function(e){var t=this,n=2025,a=e-1,s=new Date(n,a+1,0).getDate(),i=new Date(n,a,1).getDay();this.firstDayOffset=0===i?6:i-1,this.monthDays=Array.from({length:s},(function(e,s){var i=s+1;return{date:"".concat(t.selectedMonth,"-").concat(i),day:i,isPast:new Date(n,a,i)<new Date}}))},getDayAppointments:function(e){var t=e.split("-").map(Number),n=Object(kn["a"])(t,2),a=n[0],s=n[1],i="2025-".concat(a.toString().padStart(2,"0"),"-").concat(s.toString().padStart(2,"0"));return this.appointments.filter((function(e){return e.appointmentDate===i}))},formatDate:function(e){var t=new Date(e),n=t.getFullYear(),a="0".concat(t.getMonth()+1).slice(-2),s="0".concat(t.getDate()).slice(-2);return"".concat(n,"-").concat(a,"-").concat(s)}}},$n=Rn,Mn=(n("c3aa"),Object(c["a"])($n,xn,Dn,!1,null,"854e487a",null)),En=Mn.exports,On=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"chat-container"},[n("header",{staticClass:"chat-header"},[n("div",{staticClass:"header-left"},[n("div",{staticClass:"connection-status",class:{connected:e.isConnected}},[e._v("\n        ● "+e._s(e.connectionStatusText)+"\n      ")]),n("countdown-timer",{attrs:{"initial-time":e.remainingTime,"session-id":e.sessionId,"is-active":e.sessionStarted},on:{"time-up":e.handleTimeUp,tick:e.handleTick}})],1),n("button",{staticClass:"end-session-btn",on:{click:function(t){e.showConfirm=!0}}},[e._v("\n      结束会话\n    ")])]),n("ChatContainer",{ref:"chatScroll",staticClass:"main-chat",attrs:{messages:e.messages}}),n("ChatMessages",{on:{"send-message":e.addMessage}}),n("history-sidebar",{staticClass:"history-sidebar",attrs:{history:e.chatHistory},model:{value:e.sidebarVisible,callback:function(t){e.sidebarVisible=t},expression:"sidebarVisible"}}),e.showConfirm?n("div",{staticClass:"confirm-dialog"},[n("div",{staticClass:"dialog-content"},[n("p",[e._v("是否确定要结束本次会话？")]),n("div",{staticClass:"dialog-btns"},[n("button",{on:{click:e.handleShowRating}},[e._v("确定")]),n("button",{on:{click:function(t){e.showConfirm=!1}}},[e._v("取消")])])])]):e._e(),e.showRatingDialog?n("div",{staticClass:"confirm-dialog"},[n("div",{staticClass:"dialog-content"},[n("h3",[e._v("请为本次会话打分")]),n("div",{staticClass:"star-rating"},e._l(5,(function(t){return n("span",{key:t,staticClass:"star",class:{filled:t<=e.rating},on:{click:function(n){e.setRating(t)}}},[e._v("★")])}))),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.feedback,expression:"feedback"}],staticClass:"feedback-box",attrs:{placeholder:"留下你的评价（可选）"},domProps:{value:e.feedback},on:{input:function(t){t.target.composing||(e.feedback=t.target.value)}}}),n("div",{staticClass:"dialog-btns"},[n("button",{on:{click:e.submitRating}},[e._v("提交")])])])]):e._e()],1)},An=[],jn=(n("20d6"),n("5a0c")),Nn=n.n(jn),Bn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"chat-container"},e._l(e.messages,(function(e,t){return n("div",{key:t,staticClass:"message-row",class:{"user-message":"user"===e.from,"system-message":"system"===e.from}},[n("message-bubble",{attrs:{message:e}})],1)})))},Pn=[],Hn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"message-container",class:{"user-container":"user"===e.message.from,"system-container":"system"===e.message.from}},["system"!==e.message.from?n("div",{staticClass:"avatar"},[e.message.avatar?n("img",{attrs:{src:e.src/e.assets/e.head2.jpg,alt:"avatar"}}):n("span",[e._v(e._s(e.messageAvatar))])]):e._e(),n("div",{staticClass:"message-bubble",class:{"user-message":"user"===e.message.from,"system-message":"system"===e.message.from}},[n("div",{staticClass:"content"},[e._v(e._s(e.message.text))]),n("div",{staticClass:"timestamp"},[e._v(e._s(e.message.time))])])])},Ln=[],Un={props:{message:{type:Object,required:!0}},computed:{messageAvatar:function(){return"user"===this.message.from?"Q":"A"}}},Vn=Un,Wn=(n("ea9c"),Object(c["a"])(Vn,Hn,Ln,!1,null,"314c23fb",null)),Fn=Wn.exports,qn={components:{MessageBubble:Fn},props:{messages:{type:Array,default:function(){return[]}}}},zn=qn,Gn=(n("ce3d"),Object(c["a"])(zn,Bn,Pn,!1,null,"bb49b3b8",null)),Jn=Gn.exports,Kn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"chat-input"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.inputText,expression:"inputText"}],attrs:{placeholder:"输入消息..."},domProps:{value:e.inputText},on:{keydown:function(t){return!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.onEnter(t))},input:function(t){t.target.composing||(e.inputText=t.target.value)}}}),n("button",{attrs:{disabled:!e.inputText.trim()},on:{click:e.send}},[e._v("发送")])])},Yn=[],Qn={data:function(){return{inputText:""}},methods:{onEnter:function(e){if(e.shiftKey){var t=e.target.selectionStart;this.inputText=this.inputText.slice(0,t)+"\n"+this.inputText.slice(t),this.$nextTick((function(){e.target.selectionStart=e.target.selectionEnd=t+1}))}else this.send()},send:function(){var e=this.inputText.trim();e&&(this.$emit("send-message",e),this.inputText="")}}},Xn=Qn,Zn=(n("038a"),Object(c["a"])(Xn,Kn,Yn,!1,null,"11c8c508",null)),ea=Zn.exports,ta=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"countdown-timer",class:{blink:e.shouldBlink}},[e._v("\n    "+e._s(e.formattedTime)+"\n  ")]),e.remainingTime<=e.warningThreshold&&e.remainingTime>0?n("div",{staticClass:"warning-text"},[e._v("\n    咨询马上结束，请注意时间\n  ")]):e._e()])},na=[],aa={props:{initialTime:{type:Number,required:!0},sessionId:{type:[String,Number],required:!0}},data:function(){return{remainingTime:this.initialTime,shouldBlink:!1,warningThreshold:600,timer:null,currentEndTime:Date.now()+1e3*this.initialTime}},computed:{formattedTime:function(){var e=Math.floor(this.remainingTime/60),t=this.remainingTime%60;return"".concat(e,":").concat(t.toString().padStart(2,"0"))},endTimeKey:function(){return"countdown_".concat(this.sessionId)}},watch:{remainingTime:function(e){300!==e&&60!==e||this.triggerBlink()},sessionId:function(){this.initializeTimer()}},mounted:function(){this.initializeTimer()},beforeDestroy:function(){clearInterval(this.timer)},methods:{initializeTimer:function(){clearInterval(this.timer);var e=localStorage.getItem(this.endTimeKey);e||(e=Date.now()+1e3*this.initialTime,localStorage.setItem(this.endTimeKey,e)),this.currentEndTime=parseInt(e,10),this.updateRemaining(),this.timer=setInterval(this.updateRemaining,1e3)},updateRemaining:function(){var e=Date.now(),t=Math.max(0,Math.floor((this.currentEndTime-e)/1e3));this.remainingTime=t,0===t&&this.handleTimeExpired()},handleTimeExpired:function(){clearInterval(this.timer),localStorage.removeItem(this.endTimeKey),this.$emit("time-up")},triggerBlink:function(){var e=this;this.shouldBlink=!0,setTimeout((function(){e.shouldBlink=!1}),2e3)}}},sa=aa,ia=(n("8b51"),Object(c["a"])(sa,ta,na,!1,null,"7a138be1",null)),oa=ia.exports,ra=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"history-sidebar",class:{open:e.value}},[n("div",{staticClass:"sidebar-header"},[n("h3",[e._v("历史会话记录")]),n("button",{on:{click:function(t){e.$emit("input",!1)}}},[e._v("×")])]),n("div",{staticClass:"history-list"},e._l(e.history,(function(t,a){return n("div",{key:a,staticClass:"history-item"},[n("div",{staticClass:"therapist"},[e._v(e._s(t.therapist))]),n("div",{staticClass:"date"},[e._v(e._s(t.date))])])})))])},ca=[],la={props:{value:Boolean,history:Array}},ua=la,da=(n("dff7"),Object(c["a"])(ua,ra,ca,!1,null,"33668128",null)),fa=da.exports,ma={components:{ChatContainer:Jn,ChatMessages:ea,CountdownTimer:oa,HistorySidebar:fa},data:function(){return{sessionStarted:!1,sessionEnded:!1,messages:[],chatHistory:[],sidebarVisible:!1,showConfirm:!1,showRatingDialog:!1,rating:0,feedback:"",remainingTime:parseInt(localStorage.getItem("countdown_".concat(this.sessionId)))||3600,ws:null,reconnectAttempts:0,maxReconnectAttempts:5,isConnected:!1}},computed:{wsUrl:function(){var e=window.location.host,t=localStorage.getItem("token");return"ws://".concat(e,"/chat?token=").concat(t,"&sessionId=").concat(this.sessionId,"&type=0")},connectionStatusText:function(){return this.isConnected?"已连接":"连接中..."}},watch:{sessionId:function(){this.initializeWebSocket()},messages:function(){var e=this;this.$nextTick((function(){e.scrollToBottom()}))}},created:function(){this.sessionId=parseInt(this.$route.query.sessionId,10),this.initializeWebSocket(),window.addEventListener("beforeunload",this.handleBeforeUnload),window.addEventListener("beforeunload",this.confirmBeforeUnload),this.fetchHistory()},beforeDestroy:function(){this.cleanupWebSocket(),window.removeEventListener("beforeunload",this.handleBeforeUnload),window.removeEventListener("beforeunload",this.confirmBeforeUnload)},methods:{scrollToBottom:function(){var e=this.$refs.chatScroll,t=e&&e.$el?e.$el:e;t&&(t.scrollTop=t.scrollHeight)},initializeWebSocket:function(){var e=Object(yn["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.cleanupWebSocket();try{this.ws=new WebSocket(this.wsUrl),this.setupWebSocketHandlers()}catch(t){this.handleReconnect()}case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),setupWebSocketHandlers:function(){var e=this;this.ws.onopen=function(){e.isConnected=!0,e.reconnectAttempts=0},this.ws.onmessage=function(t){var n=JSON.parse(t.data);e.handleIncomingMessage(n)},this.ws.onerror=function(t){alert("WebSocket error:",t),e.isConnected=!1},this.ws.onclose=function(t){e.isConnected=!1,!t.wasClean&&e.reconnectAttempts<e.maxReconnectAttempts&&e.handleReconnect()}},confirmBeforeUnload:function(e){e.preventDefault(),e.returnValue="确定要离开本页面吗？"},handleReconnect:function(){var e=this,t=Math.min(3e3*Math.pow(2,this.reconnectAttempts),3e4);setTimeout((function(){e.reconnectAttempts++,e.initializeWebSocket()}),t)},handleIncomingMessage:function(e){var t={from:e.system?"system":"consultant",text:e.msg,time:Nn()(e.time).format("HH:mm:ss"),status:"received"};this.messages.push(t),"会话已开始"===t.text?this.sessionStarted=!0:"会话已结束"===t.text&&(alert("咨询师已结束会话！"),this.sessionEnded=!0,this.showRatingDialog=!0)},addMessage:function(){var e=Object(yn["a"])(regeneratorRuntime.mark((function e(t){var n,a,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.ws&&this.ws.readyState===WebSocket.OPEN){e.next=3;break}return alert("连接尚未建立，请稍后再试"),e.abrupt("return");case 3:n={from:"user",text:t,time:Nn()().format("HH:mm:ss"),status:"sending"};try{this.messages.push(n),a=JSON.stringify({msg:t}),this.ws.send(a),s=this.messages.length-1,this.messages[s].status="sent"}catch(o){i=this.messages.findIndex((function(e){return"sending"===e.status})),-1!==i&&(this.messages[i].status="failed")}case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),cleanupWebSocket:function(){this.ws&&(this.ws.onclose=null,this.ws.close(),this.ws=null)},handleBeforeUnload:function(){this.cleanupWebSocket()},fetchHistory:function(){var e=Object(yn["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),handleTick:function(e){localStorage.setItem("countdown_".concat(this.sessionId),e),this.remainingTime=e},handleTimeUp:function(){localStorage.removeItem("countdown_".concat(this.sessionId)),alert("本次咨询时间已到，即将结束会话"),this.confirmEndSession()},handleShowRating:function(){this.showConfirm=!1,this.showRatingDialog=!0},setRating:function(e){this.rating=e},submitRating:function(){var e=this,t=localStorage.getItem("token"),n={sessionId:this.sessionId,rate:this.rating||0,feedback:(this.feedback||"").trim()};this.rating>0?this.$axios.put("".concat(window.location.origin,"/api/user/session/evaluate"),n,{headers:{"Content-Type":"application/json",token:t}}).then((function(t){var n=t.data;"1"!==n.code?e.$message.error("提交评分失败"):(e.$message.success("评分提交成功"),e.showRatingDialog=!1,e.sessionEnded=!0,e.cleanupSession(!0))})).catch((function(){e.$message.error("提交评分失败，请稍后再试")})):this.cleanupSession(!0)},cleanupSession:function(){window.removeEventListener("beforeunload",this.confirmBeforeUnload),localStorage.removeItem("countdown_".concat(this.sessionId)),this.cleanupWebSocket(),setTimeout((function(){window.close()}),500)},confirmEndSession:function(){this.cleanupSession()}}},ha=ma,pa=(n("64ba"),Object(c["a"])(ha,On,An,!1,null,"687eba94",null)),ga=pa.exports,va=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"chat-container"},[n("header",{staticClass:"chat-header"},[n("div",{staticClass:"header-left"},[n("div",{staticClass:"connection-status",class:{connected:e.isConnected}},[e._v("\n        ● "+e._s(e.connectionStatusText)+"\n      ")]),n("div",{staticClass:"timer"},[e._v(e._s(e.formattedRemainingTime))])]),n("button",{staticClass:"end-session-btn",on:{click:function(t){e.showConfirm=!0}}},[e._v("\n      结束会话\n    ")])]),n("ChatContainer",{ref:"chatScroll",staticClass:"main-chat",attrs:{messages:e.messages}}),n("ChatMessages",{on:{"send-message":e.addMessage}}),n("history-sidebar",{staticClass:"history-sidebar",attrs:{history:e.chatHistory},model:{value:e.sidebarVisible,callback:function(t){e.sidebarVisible=t},expression:"sidebarVisible"}}),e.showConfirm?n("div",{staticClass:"confirm-dialog"},[n("div",{staticClass:"dialog-content"},[n("p",[e._v("是否确定要结束本次会话？")]),n("div",{staticClass:"dialog-btns"},[n("button",{on:{click:e.handleShowRating}},[e._v("确定")]),n("button",{on:{click:function(t){e.showConfirm=!1}}},[e._v("取消")])])])]):e._e(),e.showRatingDialog?n("div",{staticClass:"confirm-dialog"},[n("div",{staticClass:"dialog-content"},[n("h3",[e._v("请为本次会话打分")]),n("div",{staticClass:"star-rating"},e._l(5,(function(t){return n("span",{key:t,staticClass:"star",class:{filled:t<=e.rating},on:{click:function(n){e.setRating(t)}}},[e._v("★")])}))),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.feedback,expression:"feedback"}],staticClass:"feedback-box",attrs:{placeholder:"留下你的评价（可选）"},domProps:{value:e.feedback},on:{input:function(t){t.target.composing||(e.feedback=t.target.value)}}}),n("div",{staticClass:"dialog-btns"},[n("button",{on:{click:e.submitRating}},[e._v("提交")])])])]):e._e()],1)},ba=[],wa={components:{ChatContainer:Jn,ChatMessages:ea,HistorySidebar:fa},data:function(){return{sessionStarted:!1,sessionEnded:!1,messages:[],chatHistory:[],sidebarVisible:!1,showConfirm:!1,showRatingDialog:!1,rating:0,feedback:"",remainingTime:0,ws:null,reconnectAttempts:0,maxReconnectAttempts:5,isConnected:!1}},computed:{wsUrl:function(){var e=window.location.host,t=localStorage.getItem("token");return"ws://".concat(e,"/chat?token=").concat(t,"&sessionId=").concat(this.sessionId,"&type=0")},connectionStatusText:function(){return this.isConnected?"已连接":"连接中..."},formattedRemainingTime:function(){if(isNaN(this.remainingTime))return"00:00";var e=Math.abs(this.remainingTime),t=Math.floor(e/60),n=e%60,a=this.remainingTime<0?"-":"";return"".concat(a).concat(String(t).padStart(2,"0"),":").concat(String(n).padStart(2,"0"))}},watch:{sessionId:function(){this.initializeWebSocket()},messages:function(){var e=this;this.$nextTick((function(){e.scrollToBottom()}))}},created:function(){this.sessionId=parseInt(this.$route.query.sessionId,10),this.calculateRemainingTime(),this.startCountdown(),this.initializeWebSocket(),window.addEventListener("beforeunload",this.handleBeforeUnload),window.addEventListener("beforeunload",this.confirmBeforeUnload),this.fetchHistory()},beforeDestroy:function(){this.cleanupWebSocket(),window.removeEventListener("beforeunload",this.handleBeforeUnload),window.removeEventListener("beforeunload",this.confirmBeforeUnload)},methods:{scrollToBottom:function(){var e=this.$refs.chatScroll,t=e&&e.$el?e.$el:e;t&&(t.scrollTop=t.scrollHeight)},calculateRemainingTime:function(){var e=this.$route.query.startDate,t=this.$route.query.startTime,n=Nn()("".concat(e," ").concat(t)),a=n.add(1,"hour"),s=Nn()();this.remainingTime=Math.max(a.diff(s,"second"),0)},startCountdown:function(){var e=this;this.countdownInterval=setInterval((function(){e.calculateRemainingTime(),e.remainingTime<=10?(clearInterval(e.countdownInterval),e.handleTimeUp()):e.remainingTime--}),1e3)},initializeWebSocket:function(){var e=Object(yn["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.cleanupWebSocket();try{this.ws=new WebSocket(this.wsUrl),this.setupWebSocketHandlers()}catch(t){this.handleReconnect()}case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),setupWebSocketHandlers:function(){var e=this;this.ws.onopen=function(){e.isConnected=!0,e.reconnectAttempts=0},this.ws.onmessage=function(t){var n=JSON.parse(t.data);e.handleIncomingMessage(n)},this.ws.onerror=function(t){alert("WebSocket error:",t),e.isConnected=!1},this.ws.onclose=function(t){e.isConnected=!1,!t.wasClean&&e.reconnectAttempts<e.maxReconnectAttempts&&e.handleReconnect()}},confirmBeforeUnload:function(e){e.preventDefault(),e.returnValue="确定要离开本页面吗？"},handleReconnect:function(){var e=this,t=Math.min(3e3*Math.pow(2,this.reconnectAttempts),3e4);setTimeout((function(){e.reconnectAttempts++,e.initializeWebSocket()}),t)},handleIncomingMessage:function(e){var t={from:e.system?"system":"consultant",text:e.msg,time:Nn()(e.time).format("HH:mm:ss"),status:"received"};this.messages.push(t),"会话已开始"===t.text?this.sessionStarted=!0:"会话已结束"===t.text&&(alert("咨询师已结束会话！"),this.sessionEnded=!0,this.showRatingDialog=!0)},addMessage:function(){var e=Object(yn["a"])(regeneratorRuntime.mark((function e(t){var n,a,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.ws&&this.ws.readyState===WebSocket.OPEN){e.next=3;break}return alert("连接尚未建立，请稍后再试"),e.abrupt("return");case 3:n={from:"user",text:t,time:Nn()().format("HH:mm:ss"),status:"sending"};try{this.messages.push(n),a=JSON.stringify({msg:t}),this.ws.send(a),s=this.messages.length-1,this.messages[s].status="sent"}catch(o){i=this.messages.findIndex((function(e){return"sending"===e.status})),-1!==i&&(this.messages[i].status="failed")}case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),cleanupWebSocket:function(){this.ws&&(this.ws.onclose=null,this.ws.close(),this.ws=null)},handleBeforeUnload:function(){this.cleanupWebSocket()},fetchHistory:function(){var e=Object(yn["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),handleTick:function(e){localStorage.setItem("countdown_".concat(this.sessionId),e),this.remainingTime=e},handleTimeUp:function(){alert("本次咨询时间已到，即将结束会话"),this.confirmEndSession()},handleShowRating:function(){this.showConfirm=!1,this.showRatingDialog=!0},setRating:function(e){this.rating=e},submitRating:function(){var e=this,t=localStorage.getItem("token"),n={sessionId:this.sessionId,rate:this.rating||0,feedback:(this.feedback||"").trim()};this.rating>0?this.$axios.put("".concat(window.location.origin,"/api/user/session/evaluate"),n,{headers:{"Content-Type":"application/json",token:t}}).then((function(t){var n=t.data;"1"!==n.code?e.$message.error("提交评分失败"):(e.$message.success("评分提交成功"),e.showRatingDialog=!1,e.sessionEnded=!0,e.cleanupSession(!0))})).catch((function(){e.$message.error("提交评分失败，请稍后再试")})):this.cleanupSession(!0)},cleanupSession:function(){window.removeEventListener("beforeunload",this.confirmBeforeUnload),localStorage.removeItem("countdown_".concat(this.sessionId)),this.cleanupWebSocket(),setTimeout((function(){window.close()}),500)},confirmEndSession:function(){this.cleanupSession()}}},ka=wa,ya=(n("3364"),Object(c["a"])(ka,va,ba,!1,null,"6f3dd444",null)),_a=ya.exports,Ca=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"settings-container"},[n("h2",[e._v("账户设置")]),e._l(e.fields,(function(t){return n("div",{key:t.key,staticClass:"field-row"},[n("label",{attrs:{for:t.key}},[e._v(e._s(t.label))]),"checkbox"===t.type?n("input",{directives:[{name:"model",rawName:"v-model",value:e.user[t.key],expression:"user[field.key]"}],class:[{editable:e.editMode[t.key]},"field-input"],attrs:{id:t.key,readonly:!e.editMode[t.key],type:"checkbox"},domProps:{checked:Array.isArray(e.user[t.key])?e._i(e.user[t.key],null)>-1:e.user[t.key]},on:{change:function(n){var a=e.user[t.key],s=n.target,i=!!s.checked;if(Array.isArray(a)){var o=null,r=e._i(a,o);s.checked?r<0&&e.$set(e.user,t.key,a.concat([o])):r>-1&&e.$set(e.user,t.key,a.slice(0,r).concat(a.slice(r+1)))}else e.$set(e.user,t.key,i)}}}):"radio"===t.type?n("input",{directives:[{name:"model",rawName:"v-model",value:e.user[t.key],expression:"user[field.key]"}],class:[{editable:e.editMode[t.key]},"field-input"],attrs:{id:t.key,readonly:!e.editMode[t.key],type:"radio"},domProps:{checked:e._q(e.user[t.key],null)},on:{change:function(n){e.$set(e.user,t.key,null)}}}):n("input",{directives:[{name:"model",rawName:"v-model",value:e.user[t.key],expression:"user[field.key]"}],class:[{editable:e.editMode[t.key]},"field-input"],attrs:{id:t.key,readonly:!e.editMode[t.key],type:t.type},domProps:{value:e.user[t.key]},on:{input:function(n){n.target.composing||e.$set(e.user,t.key,n.target.value)}}}),n("button",{on:{click:function(n){e.toggleEdit(t.key)}}},[e._v("\n      "+e._s(e.editMode[t.key]?"保存":"编辑")+"\n    ")])])})),n("div",{staticClass:"field-row"},[n("label",{attrs:{for:"password"}},[e._v("密码")]),n("div",{staticClass:"password-section"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],class:[{editable:e.editMode.password},"field-input"],attrs:{id:"password",type:"password",readonly:!e.editMode.password,placeholder:"******"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),n("button",{on:{click:function(t){e.toggleEdit("password")}}},[e._v("\n        "+e._s(e.editMode.password?"保存":"编辑")+"\n      ")])])])],2)},Sa=[],Ia={data:function(){return{user:{phone:"15355464223",email:"2803023760@qq.com",username:localStorage.getItem("username")||"用户"},password:"",editMode:{phone:!1,email:!1,username:!1,password:!1},fields:[{key:"phone",label:"手机号",type:"tel"},{key:"email",label:"邮箱",type:"email"},{key:"username",label:"用户名",type:"text"}]}},methods:{toggleEdit:function(e){this.editMode[e]&&this.saveField(e),this.$set(this.editMode,e,!this.editMode[e])},saveField:function(e){this.$message("保存字段 ".concat(e,"成功"))}}},xa=Ia,Da=(n("78cd"),Object(c["a"])(xa,Ca,Sa,!1,null,"4c350582",null)),Ta=Da.exports,Ra=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"messages-container"},[n("el-dialog",{attrs:{visible:e.deleteConfirmVisible,title:"确认删除",width:"30%","show-close":!1},on:{"update:visible":function(t){e.deleteConfirmVisible=t}}},[n("span",[e._v("确定要删除所有已读消息吗？此操作不可撤销！")]),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.deleteConfirmVisible=!1}}},[e._v("取 消")]),n("el-button",{attrs:{type:"danger"},on:{click:e.confirmDeleteRead}},[e._v("确 定")])],1)]),n("div",{staticClass:"actions"},[n("el-button",{staticClass:"custom-btn",attrs:{type:"primary"},on:{click:e.markAllAsRead}},[e._v("全部标记为已读")]),n("el-button",{staticClass:"custom-btn",attrs:{type:"danger"},on:{click:e.deleteReadMessages}},[e._v("删除所有已读消息")])],1),0===e.messages.length?n("div",{staticClass:"no-messages"},[e._v("暂无消息")]):e._e(),n("div",{staticClass:"message-card-container"},e._l(e.sortedMessages,(function(t){return n("div",{key:t.notfId,staticClass:"message-card",on:{click:function(n){e.handleRead(t)}}},[n("div",{staticClass:"message-left"},[n("p",{staticClass:"message-content",domProps:{innerHTML:e._s(e.formatContent(t.content))}}),n("p",{staticClass:"message-time"},[e._v(e._s(e.formatTime(t.createTime)))])]),n("div",{staticClass:"message-right"},["New"===t.status?n("el-tag",{attrs:{type:"danger"}},[e._v("未读")]):n("el-tag",{attrs:{type:"success"}},[e._v("已读")])],1)])})))],1)},$a=[],Ma={data:function(){return{token:localStorage.getItem("token"),messages:[],deleteConfirmVisible:!1,unread:0}},computed:{sortedMessages:function(){return this.messages.filter((function(e){return"Deleted"!==e.status})).sort((function(e,t){return e.status!==t.status?"New"===e.status?-1:1:new Date(t.createTime)-new Date(e.createTime)}))}},mounted:function(){this.fetchMessages()},methods:{count:function(){var e=this;this.$axios.get("/user/notification",{headers:{token:this.token},params:{userId:localStorage.getItem("userId")}}).then((function(t){"1"===t.data.code&&(e.unread=t.data.data)}))},deleteReadMessages:function(){var e=this.messages.filter((function(e){return"Read"===e.status})).length;0!==e?this.deleteConfirmVisible=!0:this.$message.warning("当前没有可删除的已读消息")},confirmDeleteRead:function(){var e=this,t=this.messages.filter((function(e){return"Read"===e.status})),n=t.map((function(t){return e.$axios.delete("/user/notification",{params:{notfId:t.notfId},headers:{token:e.token}})}));Promise.all(n).then((function(){e.messages=e.messages.filter((function(e){return"Read"!==e.status})),e.$message.success("成功删除".concat(t.length,"条消息"))})).catch((function(){e.$message.error("删除操作失败")})).finally((function(){e.deleteConfirmVisible=!1}))},fetchMessages:function(){var e=this;this.$axios.get("/user/notification/list",{headers:{token:this.token},params:{userId:localStorage.getItem("userId")}}).then((function(t){"1"===t.data.code&&(e.messages=t.data.data)}))},formatTime:function(e){var t=new Date(e),n=t.getFullYear(),a=t.getMonth()+1,s=t.getDate(),i=t.getHours().toString().padStart(2,"0"),o=t.getMinutes().toString().padStart(2,"0");return"".concat(n,"-").concat(a,"-").concat(s," ").concat(i,":").concat(o)},formatContent:function(e){return e?e.split(",").map((function(e){return e.trim()})).join("<br>"):""},handleRead:function(e){var t=this;"New"===e.status&&this.$axios.put("/user/notification",{},{params:{notfId:e.notfId},headers:{token:this.token}}).then((function(n){"1"===n.data.code&&(t.$set(e,"status","Read"),t.messages=Object(Tn["a"])(t.messages))}))},markAllAsRead:function(){var e=this,t=this.messages.filter((function(e){return"New"===e.status})),n=t.map((function(t){return e.$axios.put("/user/notification",{},{params:{notfId:t.notfId},headers:{token:e.token}})}));Promise.all(n).then((function(){e.messages.forEach((function(e){"New"===e.status&&(e.status="Read")}))}))}}},Ea=Ma,Oa=(n("a39f"),Object(c["a"])(Ea,Ra,$a,!1,null,"622042e6",null)),Aa=Oa.exports,ja=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"appointment-records"},[n("el-form",{staticClass:"filter-form",attrs:{inline:!0}},[n("el-form-item",{attrs:{label:"预约时间"}},[n("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.filterDate,callback:function(t){e.filterDate=t},expression:"filterDate"}})],1),n("el-form-item",[n("el-button",{staticStyle:{"background-color":"#FFE4B5",color:"#8B4513"},on:{click:e.fetchAppointments}},[e._v("\n        筛选\n      ")])],1),n("div",{staticStyle:{color:"#333"}},[e._v("点击可取消预约")])],1),n("div",{staticClass:"appointment-card-container"},e._l(e.sortedAppointments,(function(t){return n("div",{key:t.appointmentId,staticClass:"appointment-card",on:{click:function(n){e.handleCancel(t.appointmentId)}}},[n("p",[n("strong",[e._v("咨询师：")]),e._v(e._s(t.consultantName))]),n("p",[n("strong",[e._v("预约时间：")]),e._v(e._s(t.appointmentDate)+" "+e._s(t.appointmentTime))])])}))),n("el-dialog",{staticClass:"custom-cancel-dialog",attrs:{title:"取消预约",visible:e.showCancelModal,width:"400px","border-radius":"20px"},on:{"update:visible":function(t){e.showCancelModal=t}}},[n("div",[n("p",[e._v("确定要取消该预约吗？")]),n("el-input",{staticStyle:{"margin-top":"15px"},attrs:{type:"textarea",placeholder:"请输入取消理由",rows:4},model:{value:e.leaveReason,callback:function(t){e.leaveReason=t},expression:"leaveReason"}})],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.showCancelModal=!1}}},[e._v("取 消")]),n("el-button",{staticClass:"el-button--confirm",on:{click:e.submitCancel}},[e._v("\n      确 定\n    ")])],1)])],1)},Na=[],Ba={data:function(){return{userId:localStorage.getItem("userId"),token:localStorage.getItem("token"),appointments:[],filterDate:null,showCancelModal:!1,currentAppointmentId:null,leaveReason:""}},computed:{sortedAppointments:function(){return Object(Tn["a"])(this.appointments).sort((function(e,t){var n=new Date("".concat(e.appointmentDate,"T").concat(e.appointmentTime)),a=new Date("".concat(t.appointmentDate,"T").concat(t.appointmentTime));return a-n}))}},methods:{handleCancel:function(e){this.currentAppointmentId=e,this.showCancelModal=!0,this.leaveReason=""},submitCancel:function(){var e=Object(yn["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.leaveReason.trim()){e.next=3;break}return this.$message.warning("请输入取消理由"),e.abrupt("return");case 3:return e.prev=3,e.next=6,d["a"].post("/user/cancel",{appointmentId:this.currentAppointmentId,cancellationReason:this.leaveReason},{headers:{token:this.token}});case 6:if(t=e.sent,"1"!==t.data.code){e.next=14;break}return this.$message("取消预约成功"),this.showCancelModal=!1,e.next=12,this.fetchAppointments();case 12:e.next=15;break;case 14:this.$message.error(t.data.msg);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e["catch"](3),this.$message.error("取消预约失败："+e.t0.message);case 20:case"end":return e.stop()}}),e,this,[[3,17]])})));function t(){return e.apply(this,arguments)}return t}(),fetchAppointments:function(){var e=Object(yn["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t={userId:this.userId,appointmentStatus:"BOOKED"},this.filterDate&&2===this.filterDate.length&&(t.startDate=this.formatDate(this.filterDate[0]),t.endDate=this.formatDate(this.filterDate[1])),e.next=5,this.$axios.get("/user/appointments",{headers:{token:localStorage.getItem("token")||""},params:t});case 5:n=e.sent,1===n.data.code||"1"===n.data.code?(this.appointments=(n.data.data||[]).map((function(e){return{appointmentId:e.appointmentId,userId:e.userId,consultantName:e.consultantName||"未知用户",consultantId:e.consultantId,appointmentDate:e.appointmentDate,appointmentTime:e.appointmentTime,bookingDate:e.bookingDate,status:e.status,cancellationTime:e.cancellationTime,cancellationReason:e.cancellationReason||"无理由"}})),0===n.data.data.length&&console.log("没有预约记录")):"2"===n.data.code?(this.appointments=[],console.log("没有预约记录")):console.log("获取预约记录失败："+n.data.msg),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),this.$message.error("请求失败："+e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(){return e.apply(this,arguments)}return t}(),formatDate:function(e){var t=new Date(e),n=t.getFullYear(),a="0".concat(t.getMonth()+1).slice(-2),s="0".concat(t.getDate()).slice(-2);return"".concat(n,"-").concat(a,"-").concat(s)}},created:function(){d["a"].defaults.headers.common["token"]=localStorage.getItem("token")||""},mounted:function(){this.fetchAppointments()}},Pa=Ba,Ha=(n("dd1c"),Object(c["a"])(Pa,ja,Na,!1,null,"6652a0ee",null)),La=Ha.exports;a["default"].use(sn["a"]);var Ua=[{path:"/",redirect:"/login"},{path:"/login",name:"Login",component:function(){return n.e("chunk-9fb29f5a").then(n.bind(null,"a55b"))}},{path:"/home",name:"Layout",component:vn,children:[{path:"",name:"Home",component:function(){return n.e("chunk-a893a800").then(n.bind(null,"b611"))}}]},{path:"/userHome",name:"Personal",component:function(){return n.e("chunk-fe7a90fc").then(n.bind(null,"efc1"))},children:[{path:"schedule",name:"Schedule",component:En},{path:"book",name:"book",component:La},{path:"messages",name:"messages",component:Aa},{path:"settings",name:"settings",component:Ta}]},{path:"/chat/:appointmentId",name:"Chat",component:ga},{path:"/chatnormal/:id",name:"Chatnormal",component:_a},{path:"/consultant/:id",name:"consultantDetail",component:In}],Va=new sn["a"]({mode:"history",base:"/user/",routes:Ua}),Wa=Va,Fa=(n("4dcb"),n("2f62"));a["default"].use(Fa["a"]);var qa=new Fa["a"].Store({state:{userId:null,username:null},mutations:{SET_USER_INFO:function(e,t){e.userId=t.userId,e.username=t.username},CLEAR_USER_INFO:function(e){e.userId=null,e.username=null}},actions:{setUserInfo:function(e,t){var n=e.commit;n("SET_USER_INFO",t)},clearUserInfo:function(e){var t=e.commit;t("CLEAR_USER_INFO")}}});Wa.beforeEach((function(e,t,n){if(e.meta.isLogin){var a=localStorage.getItem("userId"),s=localStorage.getItem("username"),i=localStorage.getItem("token");a&&s?(qa.dispatch("setUserInfo",{userId:a,username:s,token:i}),n()):n({name:"Login"})}else n()})),d["a"].defaults.baseURL="/api",d["a"].defaults.headers.post["Content-Type"]="application/json",d["a"].defaults.withCredentials=!0,a["default"].prototype.$axios=d["a"],a["default"].config.productionTip=!1,new a["default"]({router:Wa,store:qa,render:function(e){return e(u)}}).$mount("#app")},"63b3":function(e,t,n){},"64ba":function(e,t,n){"use strict";n("0d0a")},"6f1e":function(e,t,n){},"78cd":function(e,t,n){"use strict";n("e66f")},"80b4":function(e,t,n){},"8b51":function(e,t,n){"use strict";n("b400")},"8ea1":function(e,t,n){"use strict";n("63b3")},a39f:function(e,t,n){"use strict";n("0e3b")},b400:function(e,t,n){},b8aa:function(e,t,n){},c3aa:function(e,t,n){"use strict";n("2f5c")},ce3d:function(e,t,n){"use strict";n("80b4")},dd1c:function(e,t,n){"use strict";n("210e")},dff7:function(e,t,n){"use strict";n("6f1e")},e66f:function(e,t,n){},e6a9:function(e,t,n){"use strict";n("b8aa")},ea9c:function(e,t,n){"use strict";n("ec35")},ec35:function(e,t,n){}});
//# sourceMappingURL=app.d86a4dec.js.map