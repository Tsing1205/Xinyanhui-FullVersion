(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-29dad080"],{2582:function(e,t,s){},e46b:function(e,t,s){"use strict";s("2582")},ed9e:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"schedule-container"},[s("h2",[e._v("咨询师与来访者对话")]),s("div",{staticClass:"chat-history"},e._l(e.superviseMessages,(function(t){return s("div",{key:t.time,class:["chat-bubble",t.senderType?"consultant":"user"]},[s("div",{staticClass:"chat-meta"},[s("span",{staticClass:"sender"},[e._v(e._s(t.senderType?"咨询师":"来访者"))]),s("span",{staticClass:"time"},[e._v(e._s(e.formatTime(t.time)))])]),s("div",{staticClass:"chat-msg"},[e._v(e._s(t.msg))])])})))])},a=[],i=(s("96cf"),s("1da1")),r=s("5a0c"),c=s.n(r),o={data:function(){return{superviseMessages:[],token:localStorage.getItem("token")}},created:function(){this.fetchSuperviseHistory(),this.initSuperviseWs()},computed:{wsUrl:function(){var e=window.location.host;return"ws://".concat(e,"/observe?token=").concat(this.token,"&sessionId=").concat(this.$route.query.obId)}},methods:{fetchSuperviseHistory:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$axios.get("/internal/session/history",{params:{sessionId:parseInt(this.$route.query.obId,10)},headers:{token:this.token}});case 2:t=e.sent,s=t.data,"1"===s.code&&(this.superviseMessages=s.data);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),initSuperviseWs:function(){var e=this,t=new WebSocket(this.wsUrl());t.onmessage=function(t){var s=JSON.parse(t.data);e.superviseMessages.push(s)}},formatTime:function(e){return c()(e).format("YYYY-MM-DD HH:mm:ss")}}},u=o,d=(s("e46b"),s("0c7c")),h=Object(d["a"])(u,n,a,!1,null,"397b9028",null);t["default"]=h.exports}}]);
//# sourceMappingURL=chunk-29dad080.cb3c4b1b.js.map